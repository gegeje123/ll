var BrandAlley=BrandAlley||{};BrandAlley.catalog={init:function(){this.populateContinueUrl();this.showMessage();this.startCountdown();this.showMiniCart();this.selectBoxAction();this.categoryInfo();this.switchLogic();this.switchAction();if(BrandAlley.general.isWindowSmallerThan(960)){this.getFiltersReady();this.productsFilterTouch();}
BrandAlley.catalog.documentLoadedDoneQuickbuy();},saveCrtUrl:function(){var currentUrl=window.location.href;if(currentUrl!=''){Mage.Cookies.set('continueShoppingCatUrl',currentUrl);}},populateContinueUrl:function(){jQuery('.item a').on('click',function(){BrandAlley.catalog.saveCrtUrl();});},startCountdown:function(){jQuery('.countdown').each(function(){var obj=jQuery(this);endDate=jQuery(this).data('countdown');var finalDate=moment.tz(endDate,"Europe/London");obj.countdown(finalDate.toDate(),function(event){if(event.strftime('%D')==1){timeLeftDays=event.strftime('%-D Day');}else if(event.strftime('%D')==0){timeLeftDays='Today';}
else{timeLeftDays=event.strftime('%-D Days');}
timeLeftHrs=event.strftime('%H:%M:%S');timeLeft='<strong>'+timeLeftDays+'</strong> '+timeLeftHrs;obj.next('.counter').html(timeLeft);});});},showMessage:function(){if(jQuery('#messages_product_view li.error-msg').length>0){jQuery("#messages_product_view").show();}},showMiniCart:function(){var len=jQuery("#messages_product_view li.success-msg").length;var winW=jQuery(window).width();var sessionValue=false;if(len>0){jQuery("#mini-cart").addClass('open');jQuery("#header-cart").show();setTimeout(function(){jQuery("#header-cart").hide();},8000);sessionValue=true;}
if(!sessionValue){jQuery("#mini-cart").removeClass('open');jQuery("#header-cart").hide();}
if(!sessionValue){jQuery("#mini-cart").removeClass('open');jQuery("#header-cart").hide();}},amshopby_filters_activate_status:0,filterListOrder:["available_immediately","product_type","gender","brand","size","colour","price"],amshopby_filters_activate:function(){if(BrandAlley.catalog.amshopby_filters_activate_status==0){if(window.filter_active){var filter_exist=true;}else{var filter_exist=false;}
jQuery('.amshopby-page-container .filter-js-generated').remove();for(var group in window.filter_list.groups){if(window.filter_list.groups.hasOwnProperty(group)){for(var items in window.filter_list.groups[group].items){if(window.filter_list.groups[group].items.hasOwnProperty(items)){window.filter_list.groups[group].items[items].is_selected=0;}}}}
for(var group in window.filter_list.active.groups){if(window.filter_list.active.groups.hasOwnProperty(group)){if(typeof window.filter_list.groups[group]=='undefined'){window.filter_list.groups[group]={name:window.filter_list.active.groups[group].name,code:window.filter_list.active.groups[group].code,items:{}}}
for(var item in window.filter_list.active.groups[group].items){if(window.filter_list.active.groups[group].items.hasOwnProperty(item)){var found=false;var max=1;for(var item_target in window.filter_list.groups[group].items){if(window.filter_list.groups[group].items.hasOwnProperty(item_target)){if(window.filter_list.groups[group].items[item_target].label==window.filter_list.active.groups[group].items[item].label){found=true;window.filter_list.groups[group].items[item_target].is_selected=1;}
if(parseInt(item_target)>=max)max=parseInt(item_target);}}
if(!found){window.filter_list.groups[group].items[(max+1)]={is_selected:1,counter:0,label:window.filter_list.active.groups[group].items[item].label,option_id:window.filter_list.active.groups[group].items[item].value,value:window.filter_list.active.groups[group].items[item].value}}else{filter_exist=true;}}}}}
var $filtersJs=jQuery("<div>",{class:"filter-js-generated"});var $filtersJsGroups=jQuery("<div>",{class:"filter-js-groups"});var $filtersGroups=jQuery("<ul>",{class:"filter-groups"});jQuery('.amshopby-page-container').addClass('active');function colourBox(label){if(group=='colour'){return '<span class="filter-box '+label.toLowerCase()+'"></span>';}
return '';}
var showAvailableImmediately=false;for(index=0;index<BrandAlley.catalog.filterListOrder.length;++index){if(BrandAlley.catalog.filterListOrder[index]in window.filter_list.groups){var active_group='';group=BrandAlley.catalog.filterListOrder[index];var $filterGroup=jQuery("<ul>",{class:"filter-list"});$filterGroup.data('code',window.filter_list.groups[group].code);for(var item in window.filter_list.groups[group].items){if(window.filter_list.groups[group].items.hasOwnProperty(item)){var active='';if(parseInt(window.filter_list.groups[group].items[item].counter)>0){if(window.filter_list.groups[group].items[item].is_selected){active='active';active_group='active-group';}
if(window.filter_list.groups[group].code=='available_immediately'&&!showAvailableImmediately){showAvailableImmediately=true;}
$filterGroup.append('<li class="filter-item '+active+'" data-item="'+group+'|'+item+'">'+colourBox(window.filter_list.groups[group].items[item].label)+'<span> '+window.filter_list.groups[group].items[item].label+' <span class="filter--counter">('+window.filter_list.groups[group].items[item].counter+')</span></span><span class="filter-square"><i class="fa fa-check"></i></span></li>');}else if(window.filter_list.groups[group].items[item].is_selected){if(window.filter_list.groups[group].items[item].is_selected){active='active';active_group='active-group';filter_exist=true;}
$filterGroup.append('<li class="filter-item '+active+'" data-item="'+group+'|'+item+'">'+colourBox(window.filter_list.groups[group].items[item].label)+'<span> '+window.filter_list.groups[group].items[item].label+'</span><span class="filter-square"><i class="fa fa-check"></i></span></li>');}}}
var tempObject=jQuery('<div class="'+window.filter_list.groups[group].code+' '+active_group+' filter"></div>');tempObject.append('<h3 class="filter-header">'+window.filter_list.groups[group].name+'<i class="fa fa-angle-right"></i><i class="fa fa-angle-down"></i></h3>');var tempObjectFilter=jQuery('<div class="filterScroller slide-down-effect"></div>');tempObjectFilter.append($filterGroup);tempObject.append(tempObjectFilter);tempObject.append('<div class="filter-background"></div>');$filtersJsGroups.append(tempObject);}}
$filtersJsGroups.find('.filter-item').unbind().click(function(e){window.filter_list.groups[jQuery(this).data('item').split('|')[0]].items[jQuery(this).data('item').split('|')[1]].is_selected=!window.filter_list.groups[jQuery(this).data('item').split('|')[0]].items[jQuery(this).data('item').split('|')[1]].is_selected;jQuery(this).toggleClass('active');BrandAlley.catalog.amshopby_filters_recalculate();e.preventDefault();});$filtersJs.append($filtersJsGroups);jQuery('.floatFilter').append($filtersJs);jQuery('.filter-js-generated, .related-sales').find('.filter-header').click(function(){jQuery(this).parent().toggleClass('active-group');});if(filter_exist){jQuery('.filter-js-generated').addClass('active');jQuery('.amshopby-page-container').addClass('active');}
if(filter_exist){if(jQuery('.toolbar--refine .filter-item-clear-all').length==0){jQuery('.toolbar--refine').append('<span class="filter-item-clear-all">X <span>Clear all</span></span>');}}
jQuery('.filter-list').each(function(){var lists=jQuery(this).find('li').length;if(lists%2!==0){jQuery(this).addClass('filter-odd-number');}});if(!BrandAlley.general.isMobile()&&!BrandAlley.general.isTablet()||BrandAlley.general.isWindowGreaterThan(960)){BrandAlley.catalog.activateFilterOptions();}
jQuery('.col-main').unbind().on('click','.toolbar--refine .filter-item-clear-all',function(e){amshopby_ajax_push_state(window.filter_list.global_options.clear.url);amshopby_ajax_request(window.filter_list.global_options.clear.url);});if(showAvailableImmediately){if(jQuery('.category-description .availability--toggle').length===0){var speedTruck='<img src="/skin/frontend/ultimo/default/images/fast-delivery.png" alt="express delivery" />';jQuery('.category-description').append('<div class="category-description--delivery availability--toggle">Show only <label class="availability--toggle-switch"> <span class="wh-message" title="Get it in 2-4 days">'+speedTruck+' Express Delivery</span><input type="checkbox"><span class="filter-square"><i class="fa fa-check"></i></span></label></div>')}
BrandAlley.catalog.availableImmediatelyAction();}}
BrandAlley.catalog.amshopby_filters_activate_status=1;},availableImmediatelyAction:function(){var isAvailableImmediatelyActive=jQuery('.available_immediately .filter-item:first-child').hasClass('active'),availableImmediatelyToggle=jQuery('.availability--toggle-switch');availableImmediatelyToggle.one('click','input',function(){jQuery('.available_immediately .filter-item:first-child').trigger('click');availableImmediatelyToggle.toggleClass('active');});if(isAvailableImmediatelyActive){availableImmediatelyToggle.addClass('active');}else{availableImmediatelyToggle.removeClass('active');}},amshopby_filters_recalculate:function(){if(BrandAlley.catalog.amshopby_filters_activate_status==1){var url=window.filter_list.global_options.clear.url;var newGroup=url.indexOf('?')!=-1?false:true;for(var group in window.filter_list.groups){if(window.filter_list.groups.hasOwnProperty(group)){var groupAdded=false;for(var item in window.filter_list.groups[group].items){if(window.filter_list.groups[group].items.hasOwnProperty(item)){if(window.filter_list.groups[group].items[item].is_selected){if(groupAdded==false){if(newGroup==true){url+='?';newGroup=false;}else{url+='&';}
url+=window.filter_list.groups[group].code+'=';groupAdded=true;}else{url+=',';}
url+=window.filter_list.groups[group].items[item].option_id;}}}}}
amshopby_ajax_push_state(url);amshopby_ajax_request(url);Ajax.Responders.register({onComplete:function(o,x){if(o.url.indexOf("is_ajax=1")>0){}}});tallestLi=0;equalheight=function(container){jQuery(container).each(function(index){if(tallestLi<jQuery(this).height()){tallestLi=jQuery(this).height();}})
if(tallestLi>0){jQuery(container).height(tallestLi);}}}},documentLoadedDoneQuickbuy:function(){jQuery(".quickbuy").on("click",function(event){ev=event||window.event;var splitString=jQuery(ev.target).attr("id")||jQuery(ev.srcElement).attr("id");var productUrl=jQuery(this).attr("rel");var openBlock=jQuery('.open-block');var openBlockContainer=jQuery('.product-image-wrapper');var splitArray=splitString.split('_');var prodid=splitArray[1];var fullpath=ajaxpath+prodid;var redirect=false;openBlock.css({"display":"none","visibility":"hidden"});jQuery('.item').removeClass('active');jQuery('#quickbuywrap-'+prodid+' .content').hide();jQuery('#quickbuywrap-'+prodid+' .loader').show();jQuery('#quickbuywrap-'+prodid).css({"display":"block","visibility":"visible"});jQuery(this).parent().parent('.item').addClass('active');jQuery.ajax({url:fullpath,type:'get',success:function(res){jQuery.each(res,function(key,value){if(key=='attributes'){jQuery.each(value,function(attribute_key,attribute_value){if(attribute_key==sizeAttributeId){jQuery.each(attribute_value,function(option_key,option_value){if(option_key=='options'){jQuery.each(option_value,function(option_product,product_info){allow_qty=product_info.data_qty;});}});}});}});jQuery('#quickbuywrap-'+prodid+' .loader').hide();jQuery('#quickbuywrap-'+prodid+' .content').show();var formcontent=jQuery('#quickbuywrap-'+prodid).html();jQuery('#quickbuywrap-'+prodid).html(formcontent);var spConfig=new Product.Config(res);var container=jQuery('#wrapper-'+prodid),containerWrapper=container.find(' .container-wrapper'),leftLocation=0-containerWrapper.width(),openBlockContentWidth=openBlock.width()-16,widthForCarousel=openBlock.width()-64;containerWrapper.owlCarousel({nav:true,autoWidth:true,items:3,dots:false,margin:8,navText:['<i class="fa fa-chevron-left"></i>','<i class="fa fa-chevron-right"></i>']});if(container.find('.owl-nav').hasClass('disabled')){container.width(openBlockContentWidth);}else{container.width(widthForCarousel);container.addClass('carousel-is-on');if(container.find('.owl-stage').width()<container.width()){container.find('.owl-nav').remove();container.width(openBlockContentWidth);}}
containerWrapper.css({'left':leftLocation,'position':'relative'});if(containerWrapper.width()>400){speed=1000;}else{speed=500;}
containerWrapper.animate({'left':'0'},speed);jQuery(".quickbuyclose-"+prodid).on("click",function(event){jQuery('#quickbuywrap-'+prodid).css({"display":"none","visibility":"invisible"});jQuery(this).parent().parent().parent().parent('.item').removeClass('active');});addSelectChange();if(jQuery('#quickbuywrap-'+prodid+' .unit_size').length>0&&allow_qty>0){addSelectSimpleChange(allow_qty,prodid);}
jQuery('#quickbuywrap-'+prodid).on('submit','.buy-form',function(){if(jQuery(this).find('.container-item').hasClass('selected')||jQuery(this).find('.container-item').length==0){jQuery(this).find('.open-block--button').text('Loading...');}else{if(jQuery(this).find('.validation-advice').length==0){jQuery('<div class="validation-advice" id="advice-required-entry-attribute177">Please select a size.</div>').insertAfter(jQuery(this).find('.configurable-swatch-wrapper'));jQuery('.open-block .swatch-link').addClass('highlight');}
return false;}});},error:function(jqXHR,textStatus,errorThrown){jQuery('#quickbuywrap-'+prodid).css({"display":"none","visibility":"invisible"});jQuery(this).parent().parent('.item').removeClass('active');}});});},categoryInfo:function(){var toggleButton=jQuery('.category-description--toggle');toggleButton.on('click',function(){jQuery(this).parent().toggleClass('active');});},selectBoxAction:function(){var selectItem=jQuery('.select-style');selectItem.each(function(){var selectedItem='<span class="select-style--label">Sort by </span><span class="select-style--value">'+jQuery(this).find('.select-style--content span').html()+'</span>';jQuery(this).find('.select-style--header > span').html(selectedItem);})
selectItem.on('click',function(){jQuery(this).toggleClass('active');});},switchLogic:function(){if(BrandAlley.general.isWindowSmallerThan(600)){if(localStorage.layout!='layout-1-column'){jQuery('.amshopby-page-container').addClass('layout-2-columns');localStorage.setItem("layout","layout-2-columns");}}else{localStorage.setItem("layout","layout-1-column");jQuery('.amshopby-page-container').removeClass('layout-2-columns');}},switchAction:function(){var switchButton=jQuery('body').find('.toolbar--switch');switchButton.on('click',function(){jQuery('.amshopby-page-container').toggleClass('layout-2-columns');if(jQuery('.amshopby-page-container').hasClass('layout-2-columns')){localStorage.setItem("layout","layout-2-columns");}else{localStorage.setItem("layout","layout-1-column");}});},getFiltersReady:function(){var filterBlock=document.querySelector('.sticky-filter');if(jQuery('.filter-heading').length==0){var filterHeader=document.createElement('div');}
if(BrandAlley.general.isWindowSmallerThan(960)){if(filterBlock&&filterHeader){jQuery('.toolbar').addClass('filter_touch');filterBlock.className+=' filter-container';filterHeader.className+=' filter-heading';filterHeader.appendChild(document.querySelector('.toolbar--refine').cloneNode(true));jQuery(filterBlock).prepend(filterHeader);}}else{if(filterBlock){BrandAlley.catalog.closeFilters();jQuery('.toolbar').removeClass('filter_touch');filterBlock.className='sticky-filter';jQuery('.filter-heading').remove();}}},activateFilterOptions:function(){if(jQuery(window).width()>974){setTimeout(function(){jQuery('.filter-js-groups .filter').addClass('active-group');},500);}},applyFilters:function(){BrandAlley.catalog.switchLogic();BrandAlley.catalog.getFiltersReady();BrandAlley.catalog.productsFilterTouch();},openFilters:function(){document.body.className+=' filters-visible';jQuery('.col-main').addClass('filter-wrapper');jQuery('.filter-container').addClass('slide-up-effect');BrandAlley.catalog.activateFilterOptions();},closeFilters:function(){jQuery('.col-main').removeClass(' filter-wrapper');jQuery('.filter-header').removeClass('slide-down-effect');jQuery('.filter-container').removeClass('slide-up-effect');jQuery('body').removeClass('filters-visible');},productsFilterTouch:function(){var filterTrigger=jQuery('body').find('.toolbar-top .toolbar--refine h2'),showProducts=jQuery('body').find('.filter-heading--hide');filterTrigger.on('click',function(){if(jQuery('.filter_touch').length>0){BrandAlley.catalog.openFilters();if(BrandAlley.general.isWindowSmallerThan(960)){BrandAlley.general.setTargetHeight(jQuery('.sticky-filter'));BrandAlley.general.setTargetHeight(jQuery('html,body'));}}});showProducts.on('click',function(e){e.preventDefault();BrandAlley.catalog.closeFilters();});}}
jQuery(document).ready(function(){BrandAlley.catalog.init();var width=jQuery(window).width(),height=jQuery(window).height();jQuery(window).on('resize',function(event){if(BrandAlley.general.isMobile()||BrandAlley.general.isTablet()){if(jQuery(window).width()!=width&&jQuery(window).height()!=height){BrandAlley.catalog.applyFilters();}}else{BrandAlley.catalog.applyFilters();}});jQuery(window).bind('orientationchange',function(event){BrandAlley.catalog.applyFilters();});if(window.innerWidth>=975&&jQuery('body').hasClass('catalog-category-view')){window.isTestingCategoryFilters=false;window.isFiltersOpen=false;let stickyFiltersContainerSelector=document.querySelector(".sticky-filter");const bodySelector=document.querySelector('body');const mainColSelector=document.querySelector('.main.container .col-main');if(stickyFiltersContainerSelector){stickyFiltersContainerSelector.classList.add('filter-container');window.addEventListener('resize',function(event){window.isTestingCategoryFilters=true;if(!stickyFiltersContainerSelector.classList.contains('filter-container')&&!bodySelector.classList.contains('filters-visible')){stickyFiltersContainerSelector.classList.add('filter-container');}},true);const colMainSelector=document.querySelector('.inner-container .col-main');colMainSelector.on("click",'.amshopby-page-container',function(e){e.stopPropagation();window.isTestingCategoryFilters=false;BrandAlley.catalog.amshopby_filters_activate_status=1;if(e.target.classList.contains('toolbar--button')&&e.target.closest('.toolbar--refine')){window.develo_filter_list=window.filter_list;window.isFiltersOpen=true;jQuery("a.filter-heading--hide").prop("onclick",null);if(!document.querySelector(".filter-heading")){stickyFiltersContainerSelector=document.querySelector(".sticky-filter");let fitlerHeaderElement=document.createElement("div");fitlerHeaderElement.className="filter-heading";stickyFiltersContainerSelector.prepend(fitlerHeaderElement);}
bodySelector.classList.add('filters-visible');mainColSelector.classList.add('filter-wrapper');stickyFiltersContainerSelector.classList.add('slide-up-effect');stickyFiltersContainerSelector.classList.add('filter-container');stickyFiltersContainerSelector.addEventListener("click",function(e){window.isTestingCategoryFilters=false;});let toolbar=document.querySelector('.amshopby-page-container .toolbar--refine');let heading=document.querySelector('.sticky-filter .filter-heading');heading.appendChild(toolbar);jQuery('.sticky-filter .floatFilter').find('.filter-item').unbind().click(function(e){window.filter_list.groups[jQuery(this).data('item').split('|')[0]].items[jQuery(this).data('item').split('|')[1]].is_selected=!window.filter_list.groups[jQuery(this).data('item').split('|')[0]].items[jQuery(this).data('item').split('|')[1]].is_selected;jQuery(this).toggleClass('active');if(jQuery(".filter-js-generated .active").length){let filterClose=jQuery('a.filter-heading--hide:not(.filter-heading--close)');filterClose.css("padding","0 10px");filterClose.css("background-color","#f9de4b");}else{let filterClose=jQuery('a.filter-heading--hide:not(.filter-heading--close)');filterClose.css("background-color","unset");filterClose.css("padding","unset");}
window.develo_filter_list.groups=window.filter_list.groups;});if(jQuery('.filter-by-category').length>0){jQuery('.available_immediately .filterScroller').css('padding-top',0);}}
if(e.target.classList.contains('filter-heading--hide')||e.target.classList.contains('fa-close')||e.target.classList.contains('sticky-filter')&&e.target.closest('.amshopby-page-container')){e.preventDefault();e.stopImmediatePropagation();e.stopPropagation();window.filter_list.groups=window.develo_filter_list.groups;BrandAlley.catalog.amshopby_filters_recalculate();bodySelector.classList.remove('filters-visible');window.isFiltersOpen=false;}});}}})