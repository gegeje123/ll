var BrandAlley=BrandAlley||{};BrandAlley.general={init:function(){this.countdownTimer(),this.runLazyLoad(),this.navShopByCategory()},shouldILazy:function(){return 0<jQuery(".lazy").length},runLazyLoad:function(){this.shouldILazy()&&jQuery("img.lazy").lazyload({threshold:200})},isFlashSalePage:function(){return 0<jQuery("body.flashsales-index-displaycategory, body.flashsales-staging-displaycategory").length},isMobile:function(){var e=navigator.userAgent;return!!(/IEMobile|Windows Phone|Lumia/i.test(e)||/iPhone|iP[o]d/.test(e)||/Android/.test(e)||/BlackBerry|PlayBook|BB10/.test(e)||/Mobile Safari/.test(e))},isTablet:function(){return /Tablet|Kindle|KF|iPad/i.test(navigator.userAgent)},isAndroid:function(){return!!(-1<navigator.userAgent.indexOf("Android"))},isWindowGreaterThan:function(e){return jQuery(window).width()>e},isWindowSmallerThan:function(e){return jQuery(window).width()<e},setMobileDropDownHeight:function(){var a=jQuery("#nav"),e=jQuery(".header-primary-container").height()+32,t=jQuery("#catalog_switcher").height(),r=jQuery(window).height()-e;t&&(r-=t),jQuery(window).resize(function(){var e=jQuery(".header-primary-container").height()+32,t=jQuery("#catalog_switcher").height(),r=jQuery(window).height()-e;t&&(r-=t),jQuery(window).width()<=768&&a.height(r),768<jQuery(window).width()&&a.height("")}),this.isMobile&&a.height(r)},setTargetHeight:function(e){var t=(jQuery("html,body")?jQuery(window).height():e.height()).toString()+"px";e.css("height",t)},isProductPage:function(){return 0<jQuery("body.catalog-product-view").length},navShopByCategory:function(){jQuery(".category-type").each(function(){4<jQuery(this).find(".sub-category").length&&jQuery(this).addClass("flex-end-content")})},setUlistWidth:function(e,t){var r=jQuery(e);0<r.length&&r.each(function(){var e=0;jQuery(this).find(".container-item").each(function(){e+=parseInt(jQuery(this).outerWidth(!0))}),jQuery(this).width()<e&&jQuery(this).find(".container-wrapper").width(e+4)})},resetGlobalTimer:function(){var t=null,r=7200;if(jQuery(".cart_timer").not(".global").not(".expired").find(".countdown-cart").each(function(){elemtnId=jQuery(this).parents(".cart_timer").attr("id"),dataTime=jQuery(this).next(".counter").text();var e=dataTime.split(":");minutes=e[0],secs=e[1],dataTime=parseInt(60*minutes)+parseInt(secs),!isNaN(dataTime)&&r>dataTime&&(r=dataTime,t=jQuery(this))}),t&&0<r){var e=moment.tz(t.data("countdown"),"Europe/London");jQuery(".cart_timer.global .countdown-cart").each(function(){globalTimer=jQuery(this),globalTimer.countdown(e.toDate(),function(e){e.strftime("%M")<urgentExpireMinutes?globalTimer.parent("span").removeClass("not-urgent").addClass("urgent"):globalTimer.parent("span").removeClass("urgent").addClass("not-urgent")})})}else jQuery(".cart_timer.global").html(""),jQuery("#nav-holder1").removeClass("timer-item")},countdownTimer:function(){universal_variable.basket&&0<universal_variable.basket.line_items.length&&(cartExpiry?(jQuery(".global_timer").html(cartExpiry),jQuery(".cart_timer.global.mini").prepend("EXPIRES"),jQuery("#nav-holder1").addClass("timer-item"),errorItems=jQuery("div.item-delivery-date.error").length,oosItems=jQuery("div.item-delivery-date.oos").length,cartItems=window.universal_variable.basket.line_items.length,cartItems<=oosItems||cartItems<=errorItems?jQuery(".cart_timer.global").html(""):jQuery(".cart_timer.global.cart").show().prepend("You have item reservations expiring soon ")):(jQuery(".cart_timer.global").html(""),jQuery("#nav-holder1").removeClass("timer-item")),jQuery(".countdown-cart").each(function(){var t=jQuery(this);endDate=jQuery(this).data("countdown");var e=moment.tz(endDate,"Europe/London");var $cartTimerEl=null;var $cartCountEl=null;if(t.closest('.cart_timer').length){$cartTimerEl=t.closest('.cart_timer');}
if(t.closest('#develo-mini-cart-content').length&&t.closest('#develo-mini-cart-content').find('> .count').length){$cartCountEl=t.closest('#develo-mini-cart-content').find('> .count');}else{$cartCountEl=t.closest('.item_timer').find('> .count');}
t.countdown(e.toDate()).on("update.countdown",function(e){if(!$cartTimerEl.is(':visible')){$cartTimerEl.show();}
e.strftime("%M")<urgentMinutesToExpire?(t.parent("span").removeClass("not-urgent").addClass("urgent"),t.parents(".cart_timer").removeClass("not-urgent").addClass("urgent")):t.parents(".cart_timer").addClass("not-urgent"),timeLeft=e.strftime("%M:%S"),t.next(".counter").html(timeLeft);}).on("finish.countdown",function(e){if($cartTimerEl.is(':visible')){$cartTimerEl.hide();}
if(!$cartCountEl.is(':visible')){$cartCountEl.show();}
t.parents(".cart_timer").not(".global").addClass("expired").html("In stock but no longer reserved"),BrandAlley.general.resetGlobalTimer();if(typeof redirectToCartPage!='undefined'){window.location.href=redirectToCartPage;}})}))},blackFriday:function(){0==window.universal_variable.user.bf_active&&(jQuery(".before-bf").addClass("show"),jQuery(".bf-sales").addClass("show")),1==window.universal_variable.user.bf_day&&(jQuery(".bf-start").addClass("show"),jQuery(".main-container").addClass("bf-start-now"),jQuery(".bf-sales").addClass("show")),0==window.universal_variable.user.bf_day&&(jQuery(".main-container").addClass("bf-end-now")),0==window.universal_variable.user.bf_active&&jQuery("#bf_header").addClass("show_bf"),1==window.universal_variable.user.bf_day&&jQuery("#bf_header").addClass("show_bf"),1==window.universal_variable.user.bfNew_day&&jQuery("#bf_header").addClass("show_bf"),2==window.universal_variable.user.bf_active&&jQuery("#bf_header").addClass("show_bf"),2==window.universal_variable.user.bf_active&&(jQuery(".after-bf").addClass("show"),jQuery(".bf-sales").addClass("show")),0!=window.universal_variable.user.logged_in&&jQuery("#show-bfvoucher").removeClass("hide")},showoffer:function(){var e=parseInt(window.universal_variable.adventActive),t=jQuery(".chris_bar");26<=e&&t.hide()}},jQuery(document).ready(function(){BrandAlley.general.init(),BrandAlley.general.blackFriday(),BrandAlley.general.showoffer()}),jQuery(window).load(function(){BrandAlley.general.setUlistWidth(".more-products","mobile")}),Validation.addAllThese([["validate-alphanum-with-spaces-char","Please use only letters (a-z or A-Z),.&!, numbers (0-9) or spaces only in this field.",function(e){"use strict";return Validation.get("IsEmpty").test(e)||/^[a-zA-Z0-9 .&!]+$/.test(e)}]]);